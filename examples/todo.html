<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Miu Todo List</title>
    <style>
      ul {
        list-style-type: none;
        padding: 0;
        margin: 0;
      }
    </style>
    <script type="module" src="/miu.js"></script>
  </head>

  <body>
    <h1>Todo List</h1>

    <miu-el store="todo">
      <input data-miu-bind="newTask" placeholder="New task...">
      <button data-miu-on="click:addTask">Add</button>

      <ul data-miu-for="tasks">
        <template>
          <li>
            <input type="checkbox" data-miu-bind="done">
            <span data-miu-bind="text"></span>
            <button data-miu-on="click:removeTask">Ã—</button>
          </li>
        </template>
      </ul>

    </miu-el>

    <script type="module">
      import { Store } from '/miu.js';

      const todoStore = new Store('todo', {
        tasks: [],
        newTask: '',

        addTask() {
          if (this.newTask.trim()) {
            this.tasks.push({ text: this.newTask, done: false });
            this.newTask = '';
          }
          document.querySelector('input').focus();
        },

        removeTask(event, context) {
          this.tasks.splice(context.index, 1);
        }
      });

      document.addEventListener('DOMContentLoaded', () => {
        const input = document.querySelector('input');
        input.addEventListener('keydown', (event) => {
          if (event.key === 'Enter') {
            todoStore.addTask();
          }
        });
      });
    </script>

  </body>
</html>
